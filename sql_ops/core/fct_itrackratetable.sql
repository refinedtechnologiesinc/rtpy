with staging as (

            select * from {{ source('itrack_fivetran','itrackratetable') }}

        ),

        final as (

            select
                sha1(array_to_string(array_construct_compact(*),','))       as id,
                acct                                                        as acct,
                advflag                                                     as advflag,
                alterrate                                                   as alterrate,
                calendar                                                    as calendar,
                code                                                        as code,
                dailywkend                                                  as dailywkend,
                daytype                                                     as daytype,
                deactivate                                                  as deactivate,
                discfirst                                                   as discfirst,
                dontchargetoohnc                                            as dontchargetoohnc,
                estretsoon                                                  as estretsoon,
                fixed                                                       as fixed,
                flag_1                                                      as flag_1,
                flag_10                                                     as flag_10,
                flag_11                                                     as flag_11,
                flag_12                                                     as flag_12,
                flag_13                                                     as flag_13,
                flag_14                                                     as flag_14,
                flag_15                                                     as flag_15,
                flag_16                                                     as flag_16,
                flag_17                                                     as flag_17,
                flag_18                                                     as flag_18,
                flag_19                                                     as flag_19,
                flag_2                                                      as flag_2,
                flag_20                                                     as flag_20,
                flag_3                                                      as flag_3,
                flag_4                                                      as flag_4,
                flag_5                                                      as flag_5,
                flag_6                                                      as flag_6,
                flag_7                                                      as flag_7,
                flag_8                                                      as flag_8,
                flag_9                                                      as flag_9,
                freetype                                                    as freetype,
                hiredays                                                    as hiredays,
                insurance                                                   as insurance,
                lohdisc1                                                    as lohdisc1,
                lohdisc10                                                   as lohdisc10,
                lohdisc11                                                   as lohdisc11,
                lohdisc12                                                   as lohdisc12,
                lohdisc2                                                    as lohdisc2,
                lohdisc3                                                    as lohdisc3,
                lohdisc4                                                    as lohdisc4,
                lohdisc5                                                    as lohdisc5,
                lohdisc6                                                    as lohdisc6,
                lohdisc7                                                    as lohdisc7,
                lohdisc8                                                    as lohdisc8,
                lohdisc9                                                    as lohdisc9,
                lohper1                                                     as lohper1,
                lohper10                                                    as lohper10,
                lohper11                                                    as lohper11,
                lohper12                                                    as lohper12,
                lohper2                                                     as lohper2,
                lohper3                                                     as lohper3,
                lohper4                                                     as lohper4,
                lohper5                                                     as lohper5,
                lohper6                                                     as lohper6,
                lohper7                                                     as lohper7,
                lohper8                                                     as lohper8,
                lohper9                                                     as lohper9,
                mhpohonly                                                   as mhpohonly,
                minhire                                                     as minhire,
                mtmode                                                      as mtmode,
                mtper1                                                      as mtper1,
                mtper10                                                     as mtper10,
                mtper2                                                      as mtper2,
                mtper3                                                      as mtper3,
                mtper4                                                      as mtper4,
                mtper5                                                      as mtper5,
                mtper6                                                      as mtper6,
                mtper7                                                      as mtper7,
                mtper8                                                      as mtper8,
                mtper9                                                      as mtper9,
                name                                                        as name,
                nomtonhire                                                  as nomtonhire,
                pcent_1                                                     as pcent_1,
                pcent_10                                                    as pcent_10,
                pcent_11                                                    as pcent_11,
                pcent_12                                                    as pcent_12,
                pcent_13                                                    as pcent_13,
                pcent_14                                                    as pcent_14,
                pcent_15                                                    as pcent_15,
                pcent_16                                                    as pcent_16,
                pcent_17                                                    as pcent_17,
                pcent_18                                                    as pcent_18,
                pcent_19                                                    as pcent_19,
                pcent_2                                                     as pcent_2,
                pcent_20                                                    as pcent_20,
                pcent_3                                                     as pcent_3,
                pcent_4                                                     as pcent_4,
                pcent_5                                                     as pcent_5,
                pcent_6                                                     as pcent_6,
                pcent_7                                                     as pcent_7,
                pcent_8                                                     as pcent_8,
                pcent_9                                                     as pcent_9,
                pdceiling                                                   as pdceiling,
                per1                                                        as per1,
                per2                                                        as per2,
                per3                                                        as per3,
                per4                                                        as per4,
                pertype                                                     as pertype,
                prorata                                                     as prorata,
                recid                                                       as recid,
                recorder                                                    as recorder,
                retro                                                       as retro,
                rounddps                                                    as rounddps,
                rup1                                                        as rup1,
                rup2                                                        as rup2,
                rv                                                          as rv,
                sdpcentpw                                                   as sdpcentpw,
                shift2perc                                                  as shift2perc,
                shift3perc                                                  as shift3perc,
                sid                                                         as sid,
                splitflag                                                   as splitflag,
                subs                                                        as subs,
                tbltype                                                     as tbltype,
                timesheet                                                   as timesheet,
                transition                                                  as transition,
                tsno                                                        as tsno,
                type                                                        as type,
                uscycle                                                     as uscycle,
                usdays                                                      as usdays,
                useautotransition                                           as useautotransition,
                uselohtransition                                            as uselohtransition,
                useratepds                                                  as useratepds,
                useweek                                                     as useweek,
                uspattern                                                   as uspattern,
                usweeks                                                     as usweeks,
                wecutoffday                                                 as wecutoffday,
                wecutofftime                                                as wecutofftime,
                weekends                                                    as weekends,
                weendday                                                    as weendday,
                weendtime                                                   as weendtime,
                westartday                                                  as westartday,
                westime                                                     as westime,
                _fivetran_deleted                                           as _fivetran_deleted,
                _fivetran_synced                                            as _fivetran_synced,
      
            from staging

        )

        select * from final