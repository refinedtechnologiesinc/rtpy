with staging as (

            select * from {{ source('itrack_fivetran','itrackinvhdr') }}

        ),

        final as (

            select
                sha1(array_to_string(array_construct_compact(*),','))       as id,
                acct                                                        as acct,
                acctname                                                    as acctname,
                addr_1                                                      as addr_1,
                addr_2                                                      as addr_2,
                addr_3                                                      as addr_3,
                addr_4                                                      as addr_4,
                aftdisc                                                     as aftdisc,
                aftsett                                                     as aftsett,
                allocflag                                                   as allocflag,
                amtpaid                                                     as amtpaid,
                batchno                                                     as batchno,
                cashalloc                                                   as cashalloc,
                cashposted                                                  as cashposted,
                cashrec                                                     as cashrec,
                collchg                                                     as collchg,
                contno                                                      as contno,
                credsupamt                                                  as credsupamt,
                credsupcde                                                  as credsupcde,
                currency                                                    as currency,
                date                                                        as date,
                deladdr_1                                                   as deladdr_1,
                deladdr_2                                                   as deladdr_2,
                deladdr_3                                                   as deladdr_3,
                deladdr_4                                                   as deladdr_4,
                delchg                                                      as delchg,
                delcode                                                     as delcode,
                delemail                                                    as delemail,
                delname                                                     as delname,
                delnote                                                     as delnote,
                delpcode                                                    as delpcode,
                deposit                                                     as deposit,
                discount                                                    as discount,
                egoods                                                      as egoods,
                emailoutstanding                                            as emailoutstanding,
                emailresent                                                 as emailresent,
                emailresenttime                                             as emailresenttime,
                emailsent                                                   as emailsent,
                emailsenttime                                               as emailsenttime,
                enddate                                                     as enddate,
                endtime                                                     as endtime,
                eod                                                         as eod,
                euro                                                        as euro,
                evat                                                        as evat,
                exrate                                                      as exrate,
                fcaftdisc                                                   as fcaftdisc,
                fcgoods                                                     as fcgoods,
                fcprices                                                    as fcprices,
                fcvat                                                       as fcvat,
                goods                                                       as goods,
                hiredate                                                    as hiredate,
                hiredepot                                                   as hiredepot,
                hiretime                                                    as hiretime,
                ins                                                         as ins,
                instaxcode                                                  as instaxcode,
                instaxinc                                                   as instaxinc,
                instaxrate                                                  as instaxrate,
                instot                                                      as instot,
                invno                                                       as invno,
                invtype                                                     as invtype,
                manual                                                      as manual,
                ohtype                                                      as ohtype,
                orderedby                                                   as orderedby,
                paymeth                                                     as paymeth,
                picklist                                                    as picklist,
                postcode                                                    as postcode,
                posted                                                      as posted,
                postededi                                                   as postededi,
                postedjc                                                    as postedjc,
                postjc                                                      as postjc,
                postsl                                                      as postsl,
                proforma                                                    as proforma,
                reasoncode                                                  as reasoncode,
                reasontext                                                  as reasontext,
                recid                                                       as recid,
                recorder                                                    as recorder,
                reversecharge                                               as reversecharge,
                rv                                                          as rv,
                s50tran                                                     as s50tran,
                sellhire                                                    as sellhire,
                settdays                                                    as settdays,
                settdisc                                                    as settdisc,
                sid                                                         as sid,
                source                                                      as source,
                spcode                                                      as spcode,
                status                                                      as status,
                taxareacode                                                 as taxareacode,
                telno                                                       as telno,
                terms                                                       as terms,
                theirref                                                    as theirref,
                updateitem                                                  as updateitem,
                vat                                                         as vat,
                yourref                                                     as yourref,
                _fivetran_deleted                                           as _fivetran_deleted,
                _fivetran_synced                                            as _fivetran_synced,
      
            from staging

        )

        select * from final