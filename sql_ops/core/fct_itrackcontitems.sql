with staging as (

            select * from {{ source('itrack_fivetran','itrackcontitems') }}

        ),

        final as (

            select
                sha1(array_to_string(array_construct_compact(*),','))       as id,
                accessoriesuseitemsupplier                                  as accessoriesuseitemsupplier,
                accessoryrecid                                              as accessoryrecid,
                accessoryxhire                                              as accessoryxhire,
                acct                                                        as acct,
                addedapi                                                    as addedapi,
                addnhours                                                   as addnhours,
                addnoho                                                     as addnoho,
                baycode                                                     as baycode,
                bcoffhire                                                   as bcoffhire,
                budgetcost                                                  as budgetcost,
                calcode                                                     as calcode,
                charge                                                      as charge,
                chargedisc                                                  as chargedisc,
                cigroup                                                     as cigroup,
                cigroupname                                                 as cigroupname,
                colqty                                                      as colqty,
                container                                                   as container,
                contno                                                      as contno,
                cost                                                        as cost,
                createpo                                                    as createpo,
                currateid                                                   as currateid,
                custom1                                                     as custom1,
                custom10                                                    as custom10,
                custom2                                                     as custom2,
                custom3                                                     as custom3,
                custom4                                                     as custom4,
                custom5                                                     as custom5,
                custom6                                                     as custom6,
                custom7                                                     as custom7,
                custom8                                                     as custom8,
                custom9                                                     as custom9,
                declinezerocharge                                           as declinezerocharge,
                deldate                                                     as deldate,
                deltime                                                     as deltime,
                depot                                                       as depot,
                deviceid                                                    as deviceid,
                discfirst                                                   as discfirst,
                discount                                                    as discount,
                docdate_1                                                   as docdate_1,
                docdate_2                                                   as docdate_2,
                docdate_3                                                   as docdate_3,
                docdate_4                                                   as docdate_4,
                docdate_5                                                   as docdate_5,
                docdate_6                                                   as docdate_6,
                docdate_7                                                   as docdate_7,
                docdate_8                                                   as docdate_8,
                docno_1                                                     as docno_1,
                docno_2                                                     as docno_2,
                docno_3                                                     as docno_3,
                docno_4                                                     as docno_4,
                docno_5                                                     as docno_5,
                docno_6                                                     as docno_6,
                docno_7                                                     as docno_7,
                docno_8                                                     as docno_8,
                driver                                                      as driver,
                estretd                                                     as estretd,
                estrett                                                     as estrett,
                exchdocdatefrom                                             as exchdocdatefrom,
                exchdocdateto                                               as exchdocdateto,
                exchdocnofrom                                               as exchdocnofrom,
                exchdocnoto                                                 as exchdocnoto,
                exchreason                                                  as exchreason,
                excludesc                                                   as excludesc,
                exfrom                                                      as exfrom,
                exlastdays                                                  as exlastdays,
                extmemo                                                     as extmemo,
                exto                                                        as exto,
                farissue                                                    as farissue,
                farrecid                                                    as farrecid,
                fixamt                                                      as fixamt,
                fixdays                                                     as fixdays,
                fixrate                                                     as fixrate,
                hidemobile                                                  as hidemobile,
                hiredate                                                    as hiredate,
                hiretime                                                    as hiretime,
                includeweight                                               as includeweight,
                insurance                                                   as insurance,
                internalcost                                                as internalcost,
                invdtd                                                      as invdtd,
                invdtddisc                                                  as invdtddisc,
                invoho                                                      as invoho,
                issue                                                       as issue,
                itemdesc                                                    as itemdesc,
                itemdesc_2                                                  as itemdesc_2,
                itemdesc_3                                                  as itemdesc_3,
                itemno                                                      as itemno,
                lastino                                                     as lastino,
                lastinv                                                     as lastinv,
                lastinvt                                                    as lastinvt,
                linetot                                                     as linetot,
                lohdisc                                                     as lohdisc,
                memo                                                        as memo,
                memovis                                                     as memovis,
                meter                                                       as meter,
                meterbased                                                  as meterbased,
                mobiledelivered                                             as mobiledelivered,
                mobiledelqty                                                as mobiledelqty,
                mobiledelqtyalert                                           as mobiledelqtyalert,
                nlcc                                                        as nlcc,
                nlcode                                                      as nlcode,
                nldept                                                      as nldept,
                nodays                                                      as nodays,
                nodisc                                                      as nodisc,
                notonpaperwork                                              as notonpaperwork,
                ohrec                                                       as ohrec,
                operator                                                    as operator,
                operatorgrouprecid                                          as operatorgrouprecid,
                originalestretd                                             as originalestretd,
                originalestrett                                             as originalestrett,
                originalgroup                                               as originalgroup,
                originalitemno                                              as originalitemno,
                originaltype                                                as originaltype,
                origirecid                                                  as origirecid,
                ourordno                                                    as ourordno,
                packqty                                                     as packqty,
                paritem                                                     as paritem,
                pencilled                                                   as pencilled,
                pirecid                                                     as pirecid,
                plprinted                                                   as plprinted,
                poacct                                                      as poacct,
                poordno                                                     as poordno,
                poqty                                                       as poqty,
                priceagreed                                                 as priceagreed,
                priority                                                    as priority,
                prtflags                                                    as prtflags,
                qppdesc                                                     as qppdesc,
                qty                                                         as qty,
                qtypacked                                                   as qtypacked,
                qtypicked                                                   as qtypicked,
                qtyretd                                                     as qtyretd,
                ratecode                                                    as ratecode,
                ratetocust                                                  as ratetocust,
                rate_1                                                      as rate_1,
                rate_10                                                     as rate_10,
                rate_2                                                      as rate_2,
                rate_3                                                      as rate_3,
                rate_4                                                      as rate_4,
                rate_5                                                      as rate_5,
                rate_6                                                      as rate_6,
                rate_7                                                      as rate_7,
                rate_8                                                      as rate_8,
                rate_9                                                      as rate_9,
                recid                                                       as recid,
                recorder                                                    as recorder,
                resource                                                    as resource,
                roworder                                                    as roworder,
                rv                                                          as rv,
                safeflag                                                    as safeflag,
                safemode                                                    as safemode,
                safetype                                                    as safetype,
                salegroup                                                   as salegroup,
                sccode                                                      as sccode,
                sid                                                         as sid,
                specialrate                                                 as specialrate,
                spl                                                         as spl,
                status                                                      as status,
                subgrp                                                      as subgrp,
                suspdays                                                    as suspdays,
                susptotal                                                   as susptotal,
                tofollow                                                    as tofollow,
                totalcost                                                   as totalcost,
                type                                                        as type,
                uelastinv                                                   as uelastinv,
                uncollect                                                   as uncollect,
                vatcode                                                     as vatcode,
                weight                                                      as weight,
                xhacct                                                      as xhacct,
                xhcost                                                      as xhcost,
                xhdiscount                                                  as xhdiscount,
                xhoffhref                                                   as xhoffhref,
                xhoffhsupp                                                  as xhoffhsupp,
                _fivetran_deleted                                           as _fivetran_deleted,
                _fivetran_synced                                            as _fivetran_synced,
      
            from staging

        )

        select * from final