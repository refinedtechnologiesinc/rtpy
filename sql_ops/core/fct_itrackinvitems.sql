with staging as (

            select * from {{ source('itrack_fivetran','itrackinvitems') }}

        ),

        final as (

            select
                sha1(array_to_string(array_construct_compact(*),','))       as id,
                addnhours                                                   as addnhours,
                admincost                                                   as admincost,
                amended                                                     as amended,
                calnondays                                                  as calnondays,
                charge                                                      as charge,
                chargedisc                                                  as chargedisc,
                cigroup                                                     as cigroup,
                cigroupname                                                 as cigroupname,
                ciparitem                                                   as ciparitem,
                cirecid                                                     as cirecid,
                contno                                                      as contno,
                cost                                                        as cost,
                credsup                                                     as credsup,
                currateid                                                   as currateid,
                damflag                                                     as damflag,
                depot                                                       as depot,
                discfirst                                                   as discfirst,
                discount                                                    as discount,
                dnote                                                       as dnote,
                enddate                                                     as enddate,
                endtime                                                     as endtime,
                exenddays                                                   as exenddays,
                exhiredays                                                  as exhiredays,
                farposted                                                   as farposted,
                farrecid                                                    as farrecid,
                fixamt                                                      as fixamt,
                fixdays                                                     as fixdays,
                fixrate                                                     as fixrate,
                hdisc                                                       as hdisc,
                hiredate                                                    as hiredate,
                hiredays                                                    as hiredays,
                hiretime                                                    as hiretime,
                homedepot                                                   as homedepot,
                hours                                                       as hours,
                initial                                                     as initial,
                insurance                                                   as insurance,
                invno                                                       as invno,
                itemdesc_1                                                  as itemdesc_1,
                itemdesc_2                                                  as itemdesc_2,
                itemdesc_3                                                  as itemdesc_3,
                itemno                                                      as itemno,
                l50dept                                                     as l50dept,
                lastinv                                                     as lastinv,
                linkedxhire                                                 as linkedxhire,
                lohaddn                                                     as lohaddn,
                lohdisc                                                     as lohdisc,
                lostflag                                                    as lostflag,
                memo                                                        as memo,
                memovis                                                     as memovis,
                meterextcharge                                              as meterextcharge,
                meterexthrs                                                 as meterexthrs,
                meterextrate                                                as meterextrate,
                meterstdcharge                                              as meterstdcharge,
                meterstdhrs                                                 as meterstdhrs,
                meterstdrate                                                as meterstdrate,
                nlcc                                                        as nlcc,
                nlcode                                                      as nlcode,
                nldept                                                      as nldept,
                nodays                                                      as nodays,
                nodisc                                                      as nodisc,
                noweeks                                                     as noweeks,
                ohcont                                                      as ohcont,
                ohnote                                                      as ohnote,
                packqty                                                     as packqty,
                paritem                                                     as paritem,
                projcost                                                    as projcost,
                qppdesc                                                     as qppdesc,
                qty                                                         as qty,
                qtyiss                                                      as qtyiss,
                qtylretd                                                    as qtylretd,
                ratecode                                                    as ratecode,
                readdate                                                    as readdate,
                reading                                                     as reading,
                recid                                                       as recid,
                recorder                                                    as recorder,
                refno                                                       as refno,
                resource                                                    as resource,
                retstock                                                    as retstock,
                rslot                                                       as rslot,
                rv                                                          as rv,
                safemode                                                    as safemode,
                safetype                                                    as safetype,
                sid                                                         as sid,
                subtype                                                     as subtype,
                susp                                                        as susp,
                tofollow                                                    as tofollow,
                tsrec                                                       as tsrec,
                type                                                        as type,
                ueenddate                                                   as ueenddate,
                uehiredate                                                  as uehiredate,
                vatcode                                                     as vatcode,
                wrate                                                       as wrate,
                _fivetran_deleted                                           as _fivetran_deleted,
                _fivetran_synced                                            as _fivetran_synced,
      
            from staging

        )

        select * from final